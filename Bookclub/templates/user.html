{% extends "layout.html" %}

{% block content %}

<div class="container">
    <h2 class="header">User Profile</h2>
    <div class="user-profile">
        <div class="profile-left">
            <h1>{{ user.username }}</h1>
            <img class="main-author-image" src="{{ url_for('static', filename='profile_pics/' + user.image_file) }}"
                alt="Author Image">
        </div>
        <div class="profile-right">
            {% if user.about_me %}
            <section id="about-me">
                <h4>About Me Details</h4> <!-- Heading for about me section -->
                <p>{{ user.about_me }}</p> <!-- Display user's about me details -->
            </section>
            {% endif %}
            
            {% if user.last_seen %}<p>Last seen on: {{ user.last_seen.strftime('%Y-%m-%d %H:%M') }}</p>{% endif %} <!-- Display user's last seen date and time -->
            <p>{{ user.followers_count() }} followers, {{ user.following_count() }} following.</p> <!-- Display user's followers and following count -->

            <div class="profile-right2">
                {% if user == current_user %}
                <a class="btn-edit-profile" href="{{ url_for('main.profile') }}">
                    <i class="fa-solid fa-user"></i> Edit profile
                </a>

                {% elif not current_user.is_following(user) %}
                <form action="{{ url_for('main.follow', username=user.username) }}" method="post">
                    {{ follow_form.hidden_tag() }}
                    <button type="submit" class="btn-follow">
                        <i class="fa-solid fa-user-plus"></i> Follow
                    </button>
                </form>
                {% else %}
                <form action="{{ url_for('main.unfollow', username=user.username) }}" method="post">
                    {{ unfollow_form.hidden_tag() }}
                    <button type="submit" class="btn-unfollow">
                        <i class="fa-solid fa-user-minus"></i> Unfollow
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div class="posts-wrapper">
    <h2 class="post-header">Posts by {{ user.username }}</h2> <!-- Heading for user's posts -->
    <div class="user-posts">
        {% if posts %}
        {% for post in posts %}
        <div class="post-item">
            <h4><a href="{{ url_for('main.post', post_id=post.id)}}">{{ post.title }}</a></h4> <!-- Display post title with link to post details -->
            <p><a href="{{ url_for('main.post', post_id=post.id)}}">{{ post.content }}</a></p> <!-- Display post content with link to post details -->
            <small>Posted on {{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</small> <!-- Display post date and time -->
        </div>
        {% endfor %}
        {% else %}
        <p>No posts yet.</p> <!-- Display message if user has no posts -->
        {% endif %}
    </div>
</div>

{% endblock %}
