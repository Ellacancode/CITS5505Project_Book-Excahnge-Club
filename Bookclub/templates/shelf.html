{% extends "layout.html" %}

<!-- This block is used to add extra css to the login page -->
{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='shelf.css') }}">

{% endblock %}


{% block content %}
<header>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
</header>
<div class="shelf-tit">
    <p>BOOK SHELF</p>
</div>

<br/>
<form action="{{ url_for('search_books') }}" method="post" class="shelf-searchbox">
    <select name="search_by" class="shelf-selector">
        <option value="book_title">Book Name</option>
        <option value="genre">Genre</option>
        <option value="author">Author</option>
        <option value="publisher">Publisher</option>
        <option value="id">Book ID</option>
        <option value="status">Status</option>
        <option value="isbn">ISBN</option>
    </select>
    <input type="text" name="query" placeholder="Search for books..." class="shelf-searcher">
    <button type="submit" class="shelf-btn">Search</button>
</form>
{% if results %}
    <ul>
    {% for book in results %}
        <li>{{ book.name }} by {{ book.author }} - {{ book.genre }}</li>
    {% endfor %}
    </ul>
{% endif %}

<div class="shelf-container">
    <div class="row">
    {% for book in books %}
      <div class="col-md-3 col-cub">
        <div class="shelf-book">
            <button 
                type="button" 
                class="btn btn-info btn-lg" 
                data-toggle="modal" 
                data-target="#myModal" 
                data-book-id="{{ book.id }}" 
                data-book-title="{{book.title}}"
                data-book-author="{{ book.author }}" 
                data-book-isbn="{{ book.isbn }}" 
                data-book-genre="{{ book.genre }}" 
                data-book-status="{{ book.status }}" 
                style="width: 100%; height: 100%; background-color: rgba(255, 255, 255, 0); border: hidden;">
                <img src="../static/shelf_pics/default.png" style="width: 100%; height: 90%; border-radius: 25px; z-index: 1;" class="shelf-img">
            </button>
            <p class="col-content">{{book.title}}</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
        
  <div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modal-id"></p>
                <p id="modal-tit"></p>
                <p id="modal-aut"></p>
                <p id="modal-isbn"></p>
                <p id="modal-gen"></p>
                <p id="modal-sta"></p>
                <!-- <div id="modal-sta2" style="background-color: red; width: 100px; color: white; border-radius: 20px; text-align: center;"></div> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    $('#myModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget);
        var bookId = button.data('book-id');
        var bookTit = button.data('book-title')
        var bookAut = button.data('book-author')
        var bookIsbn = button.data('book-isbn')
        var bookGen = button.data('book-genre')
        var bookSta = button.data('book-status')

        // Update the modal's content
        var modal = $(this);
        modal.find('.modal-body #modal-id').html('<strong>Book ID:</strong>&nbsp; ' + bookId);
        modal.find('.modal-body #modal-tit').html('<strong>Book Title:</strong>&nbsp; ' + bookTit);
        modal.find('.modal-body #modal-aut').html('<strong>Book Author:</strong>&nbsp; ' + bookAut);
        modal.find('.modal-body #modal-isbn').html('<strong>Book Isbn:</strong>&nbsp; ' + bookIsbn);
        modal.find('.modal-body #modal-gen').html('<strong>Book Genre:</strong>&nbsp; ' + bookGen);
        if (bookSta === 'available') {
            modal.find('.modal-body #modal-sta').html('<div style="background-color: green; width: 100px; color: white; border-radius: 20px; text-align: center;">' + bookSta + '</div>');
        } 
        else{
            modal.find('.modal-body #modal-sta').html('<div style="background-color: red; width: 100px; color: white; border-radius: 20px; text-align: center;">' + bookSta + '</div>');
        }
    });
</script>


{% endblock content %}
